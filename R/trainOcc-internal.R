################################################################################
.constructtrainOcc <- function(x, u=u, mask=mask, time.train=time.train, 
                               funcCall=funcCall, funcCallUpdate=NULL, ...) {
  
  ### predict u
  dong <- proc.time()
  if (is.null(u)) {
    pred.un.new <- NULL
  } else{
    if (class(u)=="RasterBrick" |
        class(u)=="RasterStack" ) {
      pred.un.new <- predict(u, x, type='prob')
      #browser()
      if (!is.null(mask))
        pred.un.new <- extract(pred.un.new, which(!is.na(values(mask))))
      else
        pred.un.new <- pred.un.new[]
    } else {
      pred.un.new <- predict(x, u, type='prob')$pos
      #    browser()
      #    identical(pred.un.new, x$predUn)
    } 
  }
  time.pred <- proc.time()-dong
  
  ### create the trainOcc objct 
  newX <- structure( c ( x,
                         list(callOc = funcCall,
                              callUpdateOc = funcCallUpdate,
                              dotsOc = list(...), 
                              predUn = pred.un.new,
                              # raster = dummy$raster,
                              timeOc = list(train=time.train, pred=time.pred))),
                     class = c("trainOcc", "train") )
  
  # hist(pred.un)
  # hist(newX$predUn)
  
  
  # names(trainbject)
  #  [1] "method"       "modelInfo"    "modelType"    "results"      "pred"         "bestTune"    
  #  [7] "call"         "dots"         "metric"       "control"      "finalModel"   "preProcess"  
  # [13] "trainingData" "resample"     "resampledCM"  "perfNames"    "maximize"     "yLimits"     
  # [19] "times" 
  return(newX)
}

.Random.seed <-
  c(403L, 10L, 1357584638L, 772704952L, 1026405531L, -1575128327L, 
    1937716296L, -777136266L, -1972727119L, -2028117277L, -1446215246L, 
    -1099722236L, -344938169L, 1269707805L, 1484212884L, -662904262L, 
    -1546064763L, 86651231L, 1223090662L, -791392144L, -637643885L, 
    1477850161L, -711288096L, -1219323010L, -1111797239L, 2019342907L, 
    -2137644022L, 517889004L, 900460655L, -638660699L, 45504348L, 
    2100132658L, -4365779L, -1918799641L, 36258318L, 267050984L, 
    -261553685L, -1835715959L, 1098631704L, -1750539962L, 1831636897L, 
    -25017805L, -1424195678L, -510035308L, 1784811799L, -427675891L, 
    1102194212L, 767086090L, 38082421L, -590282033L, 476534230L, 
    -1471202944L, 811938243L, 734381921L, -1836458544L, 2027777326L, 
    708623577L, 1248655083L, 323367770L, -1891392228L, 602911775L, 
    -577341323L, -260356852L, 230140130L, 1100554685L, 1347135031L, 
    -1498612514L, -121419752L, -485189765L, 1143256857L, 1014672296L, 
    102234966L, 1468466129L, 689170307L, 1156280850L, 248399268L, 
    1105535335L, -397922627L, -775064012L, -1357591142L, -1368884763L, 
    1922270591L, 1642999046L, 18896528L, 336584499L, -1328096047L, 
    448947840L, 516149086L, -276960087L, 833879899L, 1427912042L, 
    1044846604L, -356011953L, -1275442939L, -1007967812L, 628384914L, 
    1220296589L, 1076004807L, 1417583790L, 605506824L, -1297159413L, 
    2141586921L, -1936330056L, 464262502L, -1654428159L, 1272363155L, 
    -703962302L, 135642356L, -678377225L, 1671741677L, -1695112316L, 
    1920646570L, 1924055829L, -967630417L, 952607158L, -839780384L, 
    -491833565L, -306870207L, 1596670768L, -72906418L, -1529062471L, 
    -746213941L, -1565442438L, -24185988L, -1828938817L, -1149795179L, 
    68610732L, 2062633090L, 2054711389L, -1723367593L, -1330494914L, 
    1486628472L, -1181842085L, 2115175609L, -197972728L, -823316554L, 
    -1009789711L, -1770507485L, -933755534L, -20766780L, 1789840263L, 
    -1181206179L, -313829548L, -745960070L, 196008133L, -82572769L, 
    265256358L, -1528402128L, -844782125L, 1083831281L, 72975648L, 
    -568044610L, -188982327L, 1296038779L, 699345226L, 1048077740L, 
    1071034543L, 2107271781L, 1348956700L, -953709454L, -1909861651L, 
    -1850048729L, -1773208754L, -553159768L, -66242645L, -119774007L, 
    813290712L, -1925592698L, 408215649L, 1919578611L, -1011515294L, 
    209442516L, -2046283817L, 1273568717L, -1030162076L, 2023443786L, 
    1032768693L, 1512578063L, -993282794L, 550989760L, -1303254141L, 
    1336879521L, -1739287152L, 1160136302L, 638230553L, 1218534571L, 
    1568522394L, 518873180L, 91598175L, -1821235403L, 1792170700L, 
    712955938L, -1696107907L, -1477044361L, 344402078L, -891603112L, 
    -1031208261L, -1891464103L, 35420136L, -1845345770L, 1074070929L, 
    -1570472381L, -1585009326L, -1581641244L, -1917120473L, 2006916221L, 
    1456595316L, -528241318L, -47674459L, 164993983L, 666765382L, 
    -1796045104L, 1293619443L, -1678014959L, 895582272L, 221791262L, 
    924807913L, 1057146907L, -1482145750L, -1811184820L, 599838991L, 
    1984128069L, -2121357828L, -361544622L, 2033092045L, -670468217L, 
    -1124375954L, -1269730744L, 280175691L, -1005590816L, 1525870284L, 
    -2020650848L, -1467521150L, -813500696L, -1619951892L, 394821692L, 
    -76951950L, 839302256L, -1704947164L, 1746968632L, 531920922L, 
    -74594608L, -439022532L, 184530068L, 1758746754L, -132534336L, 
    -497612484L, 2029371024L, 1011148834L, 1795692552L, -1972626292L, 
    459260956L, 1820418706L, 1271824512L, 295715860L, -1019973336L, 
    -490653126L, -775871280L, 1436769388L, 2139528884L, -660908014L, 
    -943861792L, 1518394316L, 626955744L, -86574558L, -1605360344L, 
    -1215652596L, -871139780L, -1564292878L, 1131357936L, -180695228L, 
    -1102150056L, -1526420934L, -1274417424L, 1298397372L, -1287280108L, 
    -667603774L, -1435276192L, -1636639364L, -1874810672L, 1439931426L, 
    2118981288L, 175336332L, -2123921988L, 519222322L, -994635968L, 
    -1182604108L, -1873273016L, -1755249990L, 1028337424L, 584135916L, 
    -1615578028L, 1080450834L, 2084056992L, -1070648372L, 1767951200L, 
    1542497474L, -255648216L, 661740972L, -1842881732L, 1095460722L, 
    -742408400L, 2126120484L, -1595270088L, -436963110L, 777956752L, 
    -1787749636L, 830694292L, 205164354L, -1241917952L, 635641404L, 
    -289766832L, -1053774174L, -670651576L, 2096239116L, 822622428L, 
    864238162L, -1945323392L, 1979523924L, 666107368L, -845881606L, 
    782613328L, 2014972972L, -2066937484L, 610559634L, -889262496L, 
    410551948L, 905574240L, 615576290L, 124199080L, 1475951820L, 
    412230140L, 782120882L, 1451399664L, 837096900L, 1239847768L, 
    1034125178L, 863503792L, 1930390972L, -1655124908L, -15999038L, 
    -1907140832L, -1743883332L, 1612066384L, -247813662L, -2099919512L, 
    -875461300L, 619797756L, -1767574798L, 393325312L, -715391372L, 
    867761160L, -392771142L, -1264882736L, 1310770668L, -568717420L, 
    -338190638L, 323463776L, 1782830412L, 1868910880L, 399210114L, 
    526444008L, -25744404L, 456092220L, -1947957646L, 810810224L, 
    -683149020L, -1784661448L, -1137903206L, 1946983888L, -792810052L, 
    -768400236L, -1575747454L, -2031569472L, -1288112324L, 396970128L, 
    4561698L, -671837688L, -972898036L, 1924950428L, 130279954L, 
    -1702699136L, 335926036L, -109795032L, 302116922L, -1447054384L, 
    -1969518996L, 18137652L, -1280473454L, 835743072L, -1171291828L, 
    1812042720L, -1187454558L, -851369560L, -19333492L, -210582084L, 
    327844466L, 465353712L, 1642539588L, 588845144L, 937837626L, 
    1648614512L, 1515095100L, -1385878252L, 1568813762L, 733472480L, 
    245099644L, 1391153872L, 1211457954L, 1969943592L, 751384332L, 
    -1847339588L, 1340966706L, -1623265600L, 1338857524L, -1905299768L, 
    -2003085126L, -2032237936L, 2082932460L, 1459233364L, -1205977454L, 
    -849300192L, -1729233460L, 859573984L, -263865150L, -1648358360L, 
    -2083224660L, -343660868L, -356173838L, 1528357424L, -1960903772L, 
    612857272L, 704419674L, -1590216560L, -100767876L, 1929704724L, 
    1018622274L, -2034352896L, -2016951876L, -1985671856L, -1536214750L, 
    -1687387576L, 21294092L, -1837481380L, 1285387730L, 267902464L, 
    -1960636076L, -1345825560L, 2136316154L, 914031312L, -1197191380L, 
    -1386107660L, -2029779566L, 458733920L, -626784244L, -2051553056L, 
    -419195605L, -446736740L, -1683360566L, 1413143999L, -1578417911L, 
    111567390L, 1820340172L, 78998941L, 503048231L, 1544803920L, 
    511410926L, -1943467109L, -1548060163L, 1146871018L, 2088458120L, 
    -86859471L, -1517395549L, 1295119780L, 1150257234L, -64230489L, 
    1686679537L, 2013748022L, 1365051348L, -563724955L, 113152367L, 
    -1925280856L, -563355386L, 1271873587L, -1991051627L, -1896214798L, 
    433561408L, 1282940073L, -1837268709L, -1099655444L, 522341114L, 
    800240431L, -711582919L, 813022542L, -1557709924L, 968438029L, 
    424121207L, 359286656L, -522758690L, 1484663467L, -667236947L, 
    -1109312998L, -849150760L, 445202753L, -702801421L, 1152839700L, 
    -590039646L, -1185451337L, 506911873L, -2047464314L, -1132640060L, 
    -1616402955L, -503861153L, 2099694264L, -1236831338L, 48677283L, 
    919364965L, -548793214L, -2038342160L, -1640600679L, 1490480523L, 
    740239484L, 1139129002L, -946506529L, -1216232855L, -1350352770L, 
    -1615587220L, -1144151875L, -1081208441L, -1074952848L, -309346290L, 
    1040899387L, 490668573L, 1187583690L, 931906024L, -225159471L, 
    -1457626429L, -1567159868L, -875766158L, 112172871L, -367370479L, 
    -401894762L, 685021172L, -1286684283L, -1093026609L, -1494293048L, 
    1425103974L, 1149368979L, 307651061L, -1390949422L, -633106400L, 
    -1306338807L, -1902304453L, -1547426164L, 1242934042L, -1328906865L, 
    369930969L, -1292595858L, 167850236L, -550036883L, 1306961431L, 
    -293518368L, 1510846398L, -2030649973L, 112676365L, -1013784006L, 
    -45348232L, 584942113L, -341844781L, 1927064564L, 635100290L, 
    678888727L, -685378591L, 1752208678L, 1397044260L, 1645129429L, 
    1762216575L, 132926232L, 1397609014L, 879973571L, -1015092987L, 
    -93593438L, -1655527792L, 1209508409L, 1588386539L, -109032484L, 
    1262013962L, -1309388545L, 1470924105L, 709695198L, 733043852L, 
    1019513949L, 861901415L, 890379152L, -1930047570L, 968887899L, 
    1972068925L, 1751508138L, -972757688L, 2085017969L, -1526640925L, 
    1970382308L, 1441442066L, -1122237209L, -193658191L, 215562486L, 
    380736276L, -1850090459L, -1392867025L, -1669452056L, -669533242L, 
    -1674346893L, -455610155L, 427481778L, 1264276096L, 1986081385L, 
    813811419L, 1023226412L, 998550074L, 1934177519L, -357537927L, 
    1682906126L, -481037860L, -1004674483L, 1070240183L, 1234347579L
  )
